/**
 * Frontend
 *
 * @author Your Inspiration Themes
 * @package YITH WooCommerce Ajax Navigation
 * @version 1.3.2
 */
jQuery(function ($) {
    /**
     Copyright (c) 2010, All Right Reserved, Wong Shek Hei @ shekhei@gmail.com
     License: GNU Lesser General Public License (http://www.gnu.org/licenses/lgpl.html)
     **/
    var expr = /[.#\w].([\S]*)/g, classexpr = /(?!(\[))(\.)[^.#[]*/g, idexpr = /(#)[^.#[]*/, tagexpr = /^[\w]+/, varexpr = /(\w+?)=(['"])([^\2$]*?)\2/, simpleselector = /^[\w]+$/, parseSelector = function (d) {
        for (var c = {sel: [], val: []}, a = [], j = !1, h = "", e = [], f = 0, m = d.length; f < m; f++) {
            var g = d.charAt(f);
            if (j)if ("\\" === g && f + 1 < d.length)e.push(d.charAt(++f)); else if (h === g)h = "", e.push(g); else if (("'" === g || '"' === g) && "" === h)h = g, e.push(g); else if ("]" === g && "" === h)c.val.push(e.join("")), e = [], j = !1; else {
                if ("]" !== g || "" !== h)"" === h && "," === g ? (c.val.push(e.join("")),
                    e = []) : e.push(g)
            } else"\\" === g && f + 1 < d.length ? j && e.push(d.charAt(++f)) : "[" === g && "" === h ? j = !0 : " " === g || "+" === g ? (c.sel = c.sel.join(""), a.push(c), "+" === g && a.push({sel: "+", val: ""}), c = {sel: [], val: []}) : " " !== g && "]" !== g && c.sel.push(g)
        }
        if (0 != c.sel.length || 0 != c.val.length)c.sel = c.sel.join(""), a.push(c);
        for (f = 0; f < a.length; f++) {
            c = a[f].sel;
            if ("+" === c)b.tag = c; else {
                var b = [];
                b.tag = tagexpr.exec(c);
                b.id = idexpr.exec(c);
                b.id && $.isArray(b.id) && (b.id = b.id[0].substr(1));
                b.tag || (b.tag = "div");
                b.vars = [];
                for (d = 0; d < a[f].val.length; d++)h =
                    a[f].val[d].indexOf("="), j = a[f].val[d].substr(0, h), h = a[f].val[d].substr(h + 1), h = h.replace(/^[\s]*[\"\']*|[\"\']*[\s]*$/g, ""), "text" === j ? b.text = h : b.vars.push([j, h]);
                c = c.match(classexpr);
                j = [];
                if (c) {
                    for (d = 0; d < c.length; d++)j.push(c[d].substr(1));
                    b.className = j.join(" ")
                }
            }
            a[f] = b
        }
        return a
    }, rmFromParent = function (d) {
        var c = d.parentNode, a = d.nextSibling;
        c.removeChild(d);
        return a ? function () {
            c.insertBefore(d, a)
        } : function () {
            c.appendChild(d)
        }
    }, nonArrVer = function (d, c) {
        var a = [], a = simpleselector.test(d) ? [
                {tag: d}
            ] : parseSelector(d),
            j = [];
        "undefined" === typeof c && (c = 1);
        for (var h = [], e = [], f = [], m = document.createElement("div"), g = 0, b = 0; b < a.length; b++) {
            if ("+" == a[b].tag)e = f.slice(), --g; else {
                for (var l = 0; l < c; l++)if ("input" == a[b].tag) {
                    var k = [];
                    k.push("<" + a[b].tag);
                    a[b].id && k.push("id='" + a[b].id + "'");
                    a[b].className && (k.push("class='" + a[b].className), b + 1 === a.length && k.push(lastClass), k.push("'"));
                    if (a[b].vars)for (var n = 0; n < a[b].vars.length; n++)k.push(a[b].vars[n][0] + "='" + a[b].vars[n][1] + "'");
                    a[b].text && k.push("value='" + a[b].text + "'");
                    k.push("/>");
                    f[l] = e[l];
                    e[l] ? (e[l].innerHTML += k.join(" "), e[l] = e[l].lastChild) : (m.innerHTML = k.join(" "), e[l] = m.removeChild(m.firstChild))
                } else {
                    k = document.createElement(a[b].tag);
                    if (a[b].vars)for (n = 0; n < a[b].vars.length; n++)console.log(a[b].tag, a[b].vars[n]), k.setAttribute(a[b].vars[n][0], a[b].vars[n][1]);
                    a[b].id && (k.id = a[b].id);
                    a[b].className && (k.className = a[b].className);
                    a[b].text && k.appendChild(document.createTextNode(a[b].text));
                    f[l] = e[l];
                    e[l] = e[l] ? e[l].appendChild(k) : k
                }
                g++ || Array.prototype.push.apply(h, e)
            }
            j =
                $.merge(j, e)
        }
        return $(h)
    }, arrVer = function (d, c, a) {
        for (var j = d.match(/%[^%]*%/g) || [], h = [], e = 0; e < c.length; e++) {
            for (var f = d, m = 0; m < j.length; m++)var g = j[m].substr(1, j[m].length - 2), f = f.replace(j[m], c[e][g]);
            h = $.merge(h, nonArrVer(f, a))
        }
        return $(h)
    };
    $.jseldom = function (d) {
        if (2 == arguments.length && $.isPlainObject(arguments[1]))return arrVer.apply(this, [arguments[0], [arguments[1]]]);
        if (1 == arguments.length || 2 == arguments.length && !$.isArray(arguments[1]))return nonArrVer.apply(this, arguments);
        if (2 == arguments.length)return arrVer.apply(this, arguments)
    };

    var ajax_call = false;

    var see_all_taxonomies = function(){

        var categories_link = $('#yith-wcan-reset-all-categories').find('a.yith-wcan-reset-categories-link');
        var tags_link       = $('#yith-wcan-reset-all-tags').find('a.yith-wcan-reset-tags-link');
        categories_link.add(tags_link).on('click', function (e) {
            $(this).yith_wcan_ajax_filters(e, this);
        });
    };



    $.fn.yith_wcan_ajax_filters = function (e, obj) {
        /*e.preventDefault();
        var href     = obj.href,
            t        = $(obj),
            is_reset = t.hasClass("yith-wcan-reset-navigation");

        if (typeof href == 'undefined' && t.parents().hasClass('price_slider_wrapper')) {
            var form = t.parents('form'),
                l = window.location,
                shop_uri = l.origin + l.pathname,
                is_filtered = shop_uri != l.href,
                search = l.search,
                min_price = $('.price_slider_amount #min_price').val(),
                max_price = $('.price_slider_amount #max_price').val(),
                regex_min = new RegExp('^min_price', 'i'),
                regex_max = new RegExp('^max_price', 'i');

            href = l.href;

            if (is_filtered == true) {
                href = RemoveParameterFromUrl(href, 'min_price');
                href = RemoveParameterFromUrl(href, 'max_price');
            }

            var concat = shop_uri == href  ? '?' : '&';

            href = href + concat + $.param(
                {
                    min_price: min_price,
                    max_price: max_price
                }
            );
        }

        if (t.data('type') == 'select') {

            t.parents('div.yith-woo-ajax-navigation').find('a.yit-wcan-select-open').removeClass('active');

            t.parent().find('div.yith-wcan-select-wrapper').css('z-index', '-1').animate({

                visibility: "hidden",
                opacity   : 0

            }, 300);
        }

        //loading
        $(yith_wcan.container).not('.ywcps-products').html('').addClass('yith-wcan-loading');
        $(document).trigger("yith-wcan-ajax-loading");

        if (typeof yith_wcan_frontend != 'undefined') {
            $(yith_wcan.container).not('.ywcps-products').css('backgroundImage', 'url(' + yith_wcan_frontend.loader_url + ')');
        }

        if( yith_wcan.is_mobile == 1 ){
            $(window).scrollTop( $(yith_wcan.scroll_top).offset().top );
        }

        $(yith_wcan.pagination).hide();
        $(yith_wcan.result_count).hide();

        if( ajax_call != false ){
            ajax_call.abort();
            ajax_call = false;
        }

        ajax_call = $.ajax({
            url    : href,
            success: function (response) {

                ajax_call = false;
                $(yith_wcan.container).not('.ywcps-products').removeClass('yith-wcan-loading');

                //container
                if ($(response).find(yith_wcan.container).not('.ywcps-products').length > 0) {
                    $('.yit-wcan-container').html($(response).find(yith_wcan.container).not('.ywcps-products'));
                } else {
                    $('.yit-wcan-container').html($(response).find('.woocommerce-info'));
                }

                //pagination
                if ($(response).find(yith_wcan.pagination).length > 0) {
                    //se non esiste lo creo
                    if ($(yith_wcan.pagination).length == 0) {
                        $.jseldom(yith_wcan.pagination).insertAfter($(yith_wcan.container).not('.ywcps-products'));
                    }

                    $(yith_wcan.pagination)
                        .html($(response).find(yith_wcan.pagination).html())
                        .show();
                }

                else {
                    $(yith_wcan.pagination).empty();
                }

                // quantity fields
                $('div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)').addClass('buttons_added').append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />');

                //result count
                if ($(response).find(yith_wcan.result_count).length > 0) {
                    $(yith_wcan.result_count).html($(response).find(yith_wcan.result_count).html()).show();
                }


                var widget_reload = function (t) {
                    var id = t.attr('id');
                    t.html($(response).find('#' + id).html());

                    if (t.text() == '') {
                        t.hide();
                    } else {
                        t.show();
                    }
                };

                //load new widgets
                $('.yith-woo-ajax-navigation').add('.yith-wcan-sort-by').add('.yith-wcan-stock-on-sale').add('.yith-wcan-list-price-filter').each(function () {
                    var t = $(this);
                    widget_reload(t)
                });

               
                if( yith_wcan.avada.is_enabled == 1 ) {
                    var avada_sort_count     = $(yith_wcan.avada.sort_count);
                    avada_sort_count.html($(response).find(yith_wcan.avada.sort_count).html());

                    if (t.text() == '') {
                        avada_sort_count.hide();
                    } else {
                        avada_sort_count.show();
                    }
                }

                //update browser history (IE doesn't support it)
                if (yith_wcan.change_browser_url == 1 && !navigator.userAgent.match(/msie/i)) {
                    window.history.pushState({"pageTitle": response.pageTitle}, "", href);
                }

                //trigger ready event
                $(document).trigger("ready");
                $(document).trigger("yith-wcan-ajax-filtered");
                $(window).trigger("scroll");
                if( is_reset ){
                    if( typeof $.fn.slider != 'undefined' ){
                        var min_price = parseInt( $( yith_wcan.wc_price_slider.min_price ).data( 'min' ) ),
                            max_price = parseInt( $( yith_wcan.wc_price_slider.max_price ).data( 'max' ) );
                        $( yith_wcan.wc_price_slider.wrapper ).slider( 'values', [ min_price, max_price ] );
                        $( document.body ).trigger( 'price_slider_slide', [ min_price, max_price ] );
                    }
                    $(document).trigger("yith-wcan-ajax-reset-filtered");
                }

                //See al categories in ajax
                see_all_taxonomies()
            }
        });*/
    };

    //wrap the container
    $(yith_wcan.container).not('.ywcps-products').wrap('<div class="yit-wcan-container"></div>');

    $(document).on( 'yith-wcan-wrapped', function(){
        see_all_taxonomies();
    });

    $(document).trigger( 'yith-wcan-wrapped' );

    $(document).on('click', '.yith-wcan a', function (e) {
        $(this).yith_wcan_ajax_filters(e, this);
    });



    /*AJAX NAVIGATION DROPDOWN STYLE*/
    function yit_open_select_dropdown(element) {

        $(element).parent().find('div.yith-wcan-select-wrapper').css("z-index", "1").animate({

            visibility: "visible",
            opacity   : 1


        }, 300);

        $(element).parent().find('a.yit-wcan-select-open').addClass('active');
    }

    function yit_close_select_dropdown(element) {

        $(element).parent().find('div.yith-wcan-select-wrapper').css("z-index", "-1").animate({

            visibility: "hidden",
            opacity   : 0

        }, 300);

        $(element).parent().find('a.yit-wcan-select-open').removeClass('active');
    }

    var yit_hidden_filters_wrapper = function () {

        $('div.yith-wcan-select-wrapper').css("z-index", "-1").animate({

            visibility: "hidden",
            opacity   : 0

        }, 0);

        $('a.yit-wcan-select-open').removeClass('active');
    }

    var yit_active_filter = function () {

        var filter_number = $('div.yith-wcan-select-wrapper ul.yith-wcan-select li.chosen').length;

        yit_hidden_filters_wrapper();

        $('div.yith-wcan-select-wrapper').each(function () {

            var filter_name = "";
            var chosen = $(this).find('ul.yith-wcan-select li.chosen').each(function () {
                filter_name += $(this).text() + ', ';
            });

            filter_name = filter_name.substring(0, filter_name.length - 2);

            if (filter_name != "") {
                $(this).parent().find('a.yit-wcan-select-open').text(filter_name);
            }
        })
    }

    $(document).on('click', 'a.yit-wcan-select-open.active', function (e) {
        e.preventDefault();
        yit_close_select_dropdown(this);
    });

    $(document).on('click', 'a.yit-wcan-select-open:not(.active)', function (e) {
        e.preventDefault();
        yit_open_select_dropdown(this);
    });

    $(document).on('ready yith-wcan-ajax-filtered', yit_active_filter);

    $(document).on('ready', yit_hidden_filters_wrapper);

    $('body').on('click', function (e) {

        if (!$(e.target).hasClass('yit-wcan-select-open')) {
            yit_hidden_filters_wrapper();
        }

    });

    function RemoveParameterFromUrl(url, parameter) {
        return url
            .replace(new RegExp('[?&]' + parameter + '=[^&#]*(#.*)?$'), '$1')
            .replace(new RegExp('([?&])' + parameter + '=[^&]*&'), '$1');
    }
});

//jQuery(function(a){function u(a,p){return a.replace(new RegExp("[?&]"+p+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?&])"+p+"=[^&]*&"),"$1")}var y=/(?!(\[))(\.)[^.#[]*/g,z=/(#)[^.#[]*/,A=/^[\w]+/,B=/^[\w]+$/,v=function(k,p){var b;if(B.test(k))b=[{tag:k}];else{b=k;for(var e={sel:[],val:[]},n=[],f=!1,h="",m=[],l=0,g=b.length;l<g;l++){var c=b.charAt(l);if(f)if("\\"===c&&l+1<b.length)m.push(b.charAt(++l));else if(h===c)h="",m.push(c);else if(("'"===c||'"'===c)&&""===h)h=c,m.push(c);else if("]"===c&&
//    ""===h)e.val.push(m.join("")),m=[],f=!1;else{if("]"!==c||""!==h)""===h&&","===c?(e.val.push(m.join("")),m=[]):m.push(c)}else"\\"===c&&l+1<b.length?f&&m.push(b.charAt(++l)):"["===c&&""===h?f=!0:" "===c||"+"===c?(e.sel=e.sel.join(""),n.push(e),"+"===c&&n.push({sel:"+",val:""}),e={sel:[],val:[]}):" "!==c&&"]"!==c&&e.sel.push(c)}if(0!=e.sel.length||0!=e.val.length)e.sel=e.sel.join(""),n.push(e);for(l=0;l<n.length;l++){e=n[l].sel;if("+"===e)d.tag=e;else{var d=[];d.tag=A.exec(e);d.id=z.exec(e);d.id&&a.isArray(d.id)&&
//(d.id=d.id[0].substr(1));d.tag||(d.tag="div");d.vars=[];for(b=0;b<n[l].val.length;b++)h=n[l].val[b].indexOf("="),f=n[l].val[b].substr(0,h),h=n[l].val[b].substr(h+1),h=h.replace(/^[\s]*[\"\']*|[\"\']*[\s]*$/g,""),"text"===f?d.text=h:d.vars.push([f,h]);e=e.match(y);f=[];if(e){for(b=0;b<e.length;b++)f.push(e[b].substr(1));d.className=f.join(" ")}}n[l]=d}b=n}e=[];"undefined"===typeof p&&(p=1);n=[];f=[];h=[];m=document.createElement("div");for(g=l=0;g<b.length;g++){if("+"==b[g].tag)f=h.slice(),--l;else{for(c=
//                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0;c<p;c++)if("input"==b[g].tag){d=[];d.push("<"+b[g].tag);b[g].id&&d.push("id='"+b[g].id+"'");b[g].className&&(d.push("class='"+b[g].className),g+1===b.length&&d.push(lastClass),d.push("'"));if(b[g].vars)for(var q=0;q<b[g].vars.length;q++)d.push(b[g].vars[q][0]+"='"+b[g].vars[q][1]+"'");b[g].text&&d.push("value='"+b[g].text+"'");d.push("/>");h[c]=f[c];f[c]?(f[c].innerHTML+=d.join(" "),f[c]=f[c].lastChild):(m.innerHTML=d.join(" "),f[c]=m.removeChild(m.firstChild))}else{d=document.createElement(b[g].tag);
//    if(b[g].vars)for(q=0;q<b[g].vars.length;q++)console.log(b[g].tag,b[g].vars[q]),d.setAttribute(b[g].vars[q][0],b[g].vars[q][1]);b[g].id&&(d.id=b[g].id);b[g].className&&(d.className=b[g].className);b[g].text&&d.appendChild(document.createTextNode(b[g].text));h[c]=f[c];f[c]=f[c]?f[c].appendChild(d):d}l++||Array.prototype.push.apply(n,f)}e=a.merge(e,f)}return a(n)},w=function(k,p,b){for(var e=k.match(/%[^%]*%/g)||[],n=[],f=0;f<p.length;f++){for(var h=k,m=0;m<e.length;m++)var l=e[m].substr(1,e[m].length-
//    2),h=h.replace(e[m],p[f][l]);n=a.merge(n,v(h,b))}return a(n)};a.jseldom=function(k){if(2==arguments.length&&a.isPlainObject(arguments[1]))return w.apply(this,[arguments[0],[arguments[1]]]);if(1==arguments.length||2==arguments.length&&!a.isArray(arguments[1]))return v.apply(this,arguments);if(2==arguments.length)return w.apply(this,arguments)};var r=!1,x=function(){var k=a("#yith-wcan-reset-all-categories").find("a.yith-wcan-reset-categories-link"),p=a("#yith-wcan-reset-all-tags").find("a.yith-wcan-reset-tags-link");
//    k.add(p).on("click",function(b){a(this).yith_wcan_ajax_filters(b,this)})};a.fn.yith_wcan_ajax_filters=function(k,p){k.preventDefault();var b=p.href,e=a(p),n=e.hasClass("yith-wcan-reset-navigation");if("undefined"==typeof b&&e.parents().hasClass("price_slider_wrapper")){e.parents("form");var f=window.location,h=f.origin+f.pathname,m=h!=f.href,l=a(".price_slider_amount #min_price").val(),g=a(".price_slider_amount #max_price").val(),b=f.href;1==m&&(b=u(b,"min_price"),b=u(b,"max_price"));b=b+(h==b?"?":
//        "&")+a.param({min_price:l,max_price:g})}"select"==e.data("type")&&(e.parents("div.yith-woo-ajax-navigation").find("a.yit-wcan-select-open").removeClass("active"),e.parent().find("div.yith-wcan-select-wrapper").css("z-index","-1").animate({visibility:"hidden",opacity:0},300));a(yith_wcan.container).not(".ywcps-products").html("").addClass("yith-wcan-loading");a(document).trigger("yith-wcan-ajax-loading");"undefined"!=typeof yith_wcan_frontend&&a(yith_wcan.container).not(".ywcps-products").css("backgroundImage",
//    "url("+yith_wcan_frontend.loader_url+")");1==yith_wcan.is_mobile&&a(window).scrollTop(a(yith_wcan.scroll_top).offset().top);a(yith_wcan.pagination).hide();a(yith_wcan.result_count).hide();0!=r&&(r.abort(),r=!1);r=a.ajax({url:b,success:function(c){r=!1;a(yith_wcan.container).not(".ywcps-products").removeClass("yith-wcan-loading");0<a(c).find(yith_wcan.container).not(".ywcps-products").length?a(".yit-wcan-container").html(a(c).find(yith_wcan.container).not(".ywcps-products")):a(".yit-wcan-container").html(a(c).find(".woocommerce-info"));
//    0<a(c).find(yith_wcan.pagination).length?(0==a(yith_wcan.pagination).length&&a.jseldom(yith_wcan.pagination).insertAfter(a(yith_wcan.container).not(".ywcps-products")),a(yith_wcan.pagination).html(a(c).find(yith_wcan.pagination).html()).show()):a(yith_wcan.pagination).empty();a("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").addClass("buttons_added").append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />');0<a(c).find(yith_wcan.result_count).length&&
//    a(yith_wcan.result_count).html(a(c).find(yith_wcan.result_count).html()).show();a(".yith-woo-ajax-navigation").add(".yith-wcan-sort-by").add(".yith-wcan-stock-on-sale").add(".yith-wcan-list-price-filter").each(function(){var b=a(this),d=b.attr("id");b.html(a(c).find("#"+d).html());""==b.text()?b.hide():b.show()});if(1==yith_wcan.avada.is_enabled){var d=a(yith_wcan.avada.sort_count);d.html(a(c).find(yith_wcan.avada.sort_count).html());""==e.text()?d.hide():d.show()}1!=yith_wcan.change_browser_url||
//    navigator.userAgent.match(/msie/i)||window.history.pushState({pageTitle:c.pageTitle},"",b);a(document).trigger("ready");a(document).trigger("yith-wcan-ajax-filtered");a(window).trigger("scroll");if(n){if("undefined"!=typeof a.fn.slider){var d=parseInt(a(yith_wcan.wc_price_slider.min_price).data("min")),f=parseInt(a(yith_wcan.wc_price_slider.max_price).data("max"));a(yith_wcan.wc_price_slider.wrapper).slider("values",[d,f]);a(document.body).trigger("price_slider_slide",[d,f])}a(document).trigger("yith-wcan-ajax-reset-filtered")}x()}})};
//    a(yith_wcan.container).not(".ywcps-products").wrap('<div class="yit-wcan-container"></div>');a(document).on("yith-wcan-wrapped",function(){x()});a(document).trigger("yith-wcan-wrapped");a(document).on("click",".yith-wcan a",function(k){a(this).yith_wcan_ajax_filters(k,this)});var t=function(){a("div.yith-wcan-select-wrapper").css("z-index","-1").animate({visibility:"hidden",opacity:0},0);a("a.yit-wcan-select-open").removeClass("active")};a(document).on("click","a.yit-wcan-select-open.active",function(k){k.preventDefault();
//        a(this).parent().find("div.yith-wcan-select-wrapper").css("z-index","-1").animate({visibility:"hidden",opacity:0},300);a(this).parent().find("a.yit-wcan-select-open").removeClass("active")});a(document).on("click","a.yit-wcan-select-open:not(.active)",function(k){k.preventDefault();a(this).parent().find("div.yith-wcan-select-wrapper").css("z-index","1").animate({visibility:"visible",opacity:1},300);a(this).parent().find("a.yit-wcan-select-open").addClass("active")});a(document).on("ready yith-wcan-ajax-filtered",
//        function(){a("div.yith-wcan-select-wrapper ul.yith-wcan-select li.chosen");t();a("div.yith-wcan-select-wrapper").each(function(){var k="";a(this).find("ul.yith-wcan-select li.chosen").each(function(){k+=a(this).text()+", "});k=k.substring(0,k.length-2);""!=k&&a(this).parent().find("a.yit-wcan-select-open").text(k)})});a(document).on("ready",t);a("body").on("click",function(k){a(k.target).hasClass("yit-wcan-select-open")||t()})});